# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'ShinyBatch.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


import sys,os
from PyQt5.QtCore import QUrl
from PyQt5.QtGui import *
from PyQt5.QtWidgets import *
from PyQt5.QtWebEngineWidgets import *


class ShinyWeb_Form(QMainWindow):
    def __init__(self):
        super().__init__()
        self.setWindowTitle('ShinyBatch')
        self.showMaximized()

        path = os.path.abspath('.')
        if '\\' in path:
            path = path.strip().split('\\')
            path = '/'.join(path)
            print(path)

        #####放入WebEngineView
        self.webview = WebEngineView()
        self.webview.load(QUrl('http://127.0.0.1:51896'))
        self.setCentralWidget(self.webview)

class WebEngineView(QWebEngineView):
    windowList = []
    # 重写createwindow()
    def createWindow(self, QWebEnginePage_WebWindowType):
        new_webview = WebEngineView()
        new_window = ShinyWeb_Form()
        new_window.setCentralWidget(new_webview)

        self.windowList.append(new_window)  #注：没有这句会崩溃
        return new_webview


if __name__ == '__main__':
    app = QApplication(sys.argv)
    win = ShinyWeb_Form()
    win.show()
    app.exit(app.exec_())